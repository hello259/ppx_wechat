!function(t){function n(){try{g=wx.getStorageSync("linkflow_data")||{}}catch(t){}g.scene=g.scene||"",g.appLaunchCount=g.appLaunchCount||0,g.appShowCount=g.appShowCount||0,g.appHideCount=g.appHideCount||0,g.totalPageShowCount=g.totalPageShowCount||0,g.isFirstOpen=void 0===g.isFirstOpen||g.isFirstOpen,g.firstPage=g.firstPage||"",g.lastPage=g.lastPage||"",g.appShowTime=g.appShowTime||0,g.stayDuration=g.stayDuration||0}function e(){try{wx.setStorageSync("linkflow_data",g)}catch(t){}}function a(){var t="";try{t=wx.getStorageSync("linkflow_uuid")}catch(n){t="uuid-getstoragesync"}if(!t){t=S.encode("lfapp_uuid:"+I());try{wx.setStorageSync("linkflow_uuid",t)}catch(t){wx.setStorageSync("linkflow_uuid","uuid-getstoragesync")}}return t}function o(t){var n=void 0;try{n=wx.getStorageSync("linkflow_utms_qrid")||void 0}catch(t){}if(t&&n!==t){n=t;try{wx.setStorageSync("linkflow_utms_qrid",n)}catch(t){}}return n}function r(t){for(var n in t)return!1;return!0}function i(t,n){var e=[];for(var a in n)if(n[a]instanceof Array)for(var o in n[a])n[a].hasOwnProperty(o)&&e.push(a.toString()+"="+n[a][o].toString());else e.push(a.toString()+"="+n[a].toString());return e.length>0&&(t=t+"?"+encodeURI(e.join("&"))),t}function c(n,e,a,r,c,u){if(void 0===arguments[2]&&(a="GET"),void 0===arguments[3]&&(r="api/track/wxa/event"),l&&l.token){(e=e||{}).token=l.token;var f=o(e.qrcodeId);f&&(e.qrcodeId=f);var p=i(t+"/"+r,e),h=function(){wx.request({url:p,data:n,header:{linkflow:"Wechat-miniApp"},method:a,success:function(t){"function"==typeof c&&c(t)},fail:function(t){"function"==typeof u&&u(t)}})};w?setTimeout(h,500):h()}else"function"==typeof u&&u({code:"L00002",msg:"Local Error: The js-sdk can not recognize connection tenant"})}function u(t,n,e){var o=null;t&&t.qrcodeId&&(o={qrcodeId:t.qrcodeId},delete t.qrcodeId),r(t)?"function"==typeof e&&e("no data"):l.appId?(t.lfapp_uuid=a(),t.channelType="WECHAT_WXA",t.channelId=l.appId,t.weChatInfo={appId:l.appId},c(t,o,"POST","api/track/wxa/event",n,e)):"function"==typeof e&&e("no appid")}function f(t,n,e){var o=null;if(t&&t.qrcodeId&&(o={qrcodeId:t.qrcodeId},delete t.qrcodeId),r(t))return e("no userInfo");if(r(t.wechatInfo))return e("no wechatInfo");if(l.appId){var i={lfapp_uuid:a(),channelId:l.appId,weChatInfo:{appId:l.appId}};for(var u in t)t.hasOwnProperty(u)&&("wechatInfo"===u?(t.wechatInfo.openId&&(i.weChatInfo.openId=t.wechatInfo.openId),t.wechatInfo.appId&&(i.weChatInfo.appId=t.wechatInfo.appId),t.wechatInfo.unionId&&(i.weChatInfo.unionId=t.wechatInfo.unionId)):["lfapp_uuid","channelId","weChatInfo"].indexOf(u)<0&&(i[u]=t[u]));c(i,o,"POST","api/track/wxa/identify",n,e)}else"function"==typeof e&&e("no appid")}function p(t,n,e){if(t[n]){var a=t[n];t[n]=function(t){e.call(this,t,n),a.call(this,t)}}else t[n]=function(t){e.call(this,t,n)}}function h(t,n,e){if(t[n]){var a=t[n];t[n]=function(t){var o=a.call(this,t);return e.call(this,[t,o],n),o}}else t[n]=function(t){e.call(this,t,n)}}function s(){}var d={1001:"发现栏小程序主入口",1005:"顶部搜索框的搜索结果页",1006:"发现栏小程序主入口搜索框的搜索结果页",1007:"单人聊天会话中的小程序消息卡片",1008:"群聊会话中的小程序消息卡片",1011:"扫描二维码",1012:"长按图片识别二维码",1013:"手机相册选取二维码",1014:"小程序模版消息",1017:"前往体验版的入口页",1019:"微信钱包",1020:"公众号 profile 页相关小程序列表",1022:"聊天顶部置顶小程序入口",1023:"安卓系统桌面图标",1024:"小程序 profile 页",1025:"扫描一维码",1026:"附近小程序列表",1027:"顶部搜索框搜索结果页“使用过的小程序”列表",1028:"我的卡包",1029:"卡券详情页",1030:"自动化测试下打开小程序",1031:"长按图片识别一维码",1032:"手机相册选取一维码",1034:"微信支付完成页",1035:"公众号自定义菜单",1036:"App 分享消息卡片",1037:"小程序打开小程序",1038:"从另一个小程序返回",1039:"摇电视",1042:"添加好友搜索框的搜索结果页",1043:"公众号模板消息",1044:"带 shareTicket 的小程序消息卡片（详情)",1047:"扫描小程序码",1048:"长按图片识别小程序码",1049:"手机相册选取小程序码",1052:"卡券的适用门店列表",1053:"搜一搜的结果页",1054:"顶部搜索框小程序快捷入口",1056:"音乐播放器菜单",1057:"钱包中的银行卡详情页",1058:"公众号文章",1059:"体验版小程序绑定邀请页",1064:"微信连Wi-Fi状态栏",1067:"公众号文章广告",1068:"附近小程序列表广告",1071:"钱包中的银行卡列表页",1072:"二维码收款页面",1073:"客服消息列表下发的小程序消息卡片",1074:"公众号会话下发的小程序消息卡片",1078:"连Wi-Fi成功页",1089:"微信聊天主界面下拉",1090:"长按小程序右上角菜单唤出最近使用历史",1092:"城市服务入口"},l=require("./linkflow-conf.js"),w=!0,g={};t=l.apihost||t;var I=function(){function t(t,e){var a=e||0,o=n;return o[t[a++]]+o[t[a++]]+o[t[a++]]+o[t[a++]]+"-"+o[t[a++]]+o[t[a++]]+"-"+o[t[a++]]+o[t[a++]]+"-"+o[t[a++]]+o[t[a++]]+"-"+o[t[a++]]+o[t[a++]]+o[t[a++]]+o[t[a++]]+o[t[a++]]+o[t[a++]]}for(var n=[],e=0;e<256;++e)n[e]=(e+256).toString(16).substr(1);var a,o=global.crypto||global.msCrypto;if(o&&o.getRandomValues){var r=new Uint8Array(16);a=function(){return o.getRandomValues(r),r}}if(!a){var i=new Array(16);a=function(){for(var t,n=0;n<16;n++)0==(3&n)&&(t=4294967296*Math.random()),i[n]=t>>>((3&n)<<3)&255;return i}}return function(n,e,o){var r=e&&o||0;"string"==typeof n&&(e="binary"===n?new Array(16):null,n=null);var i=(n=n||{}).random||(n.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var c=0;c<16;++c)e[r+c]=i[c];return e||t(i)}}(),S=function(){function t(t,n){var e=a.indexOf(t.charAt(n));if(-1===e)throw"Cannot decode base64";return e}function n(t,n){var e=t.charCodeAt(n);if(e>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return e}var e="=",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return{decode:function(n){var a,o,r=0,i=n.length,c=[];if(n=String(n),0===i)return n;if(i%4!=0)throw"Cannot decode base64";for(n.charAt(i-1)===e&&(r=1,n.charAt(i-2)===e&&(r=2),i-=4),a=0;a<i;a+=4)o=t(n,a)<<18|t(n,a+1)<<12|t(n,a+2)<<6|t(n,a+3),c.push(String.fromCharCode(o>>16,o>>8&255,255&o));switch(r){case 1:o=t(n,a)<<18|t(n,a+1)<<12|t(n,a+2)<<6,c.push(String.fromCharCode(o>>16,o>>8&255));break;case 2:o=t(n,a)<<18|t(n,a+1)<<12,c.push(String.fromCharCode(o>>16))}return c.join("")},encode:function(t){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";var o,r,i=[],c=(t=String(t)).length-t.length%3;if(0===t.length)return t;for(o=0;o<c;o+=3)r=n(t,o)<<16|n(t,o+1)<<8|n(t,o+2),i.push(a.charAt(r>>18)),i.push(a.charAt(r>>12&63)),i.push(a.charAt(r>>6&63)),i.push(a.charAt(63&r));switch(t.length-c){case 1:r=n(t,o)<<16,i.push(a.charAt(r>>18)+a.charAt(r>>12&63)+e+e);break;case 2:r=n(t,o)<<16|n(t,o+1)<<8,i.push(a.charAt(r>>18)+a.charAt(r>>12&63)+a.charAt(r>>6&63)+e)}return i.join("")},VERSION:"1.0"}}();n(),s.prototype={sendEvent:function(t,n,e){u(t,n,e)},onEvent:function(t,n,e){u(t,n,e)},identify:function(t,n,e){f(t,n,e)}};var v=function(t){this.linkflow=new s,g.appLaunchCount=+g.appLaunchCount+1,g.scene=d[+t.scene]||"",w=!1,e(),u({event:"WECHAT_WXA__LAUNCH",attr1:g.appLaunchCount,attr2:g.scene,attr3:g.isFirstOpen?"YES":"NO",attr4:g.firstPage||t.path,attr5:t.referrerInfo&&t.referrerInfo.appId||""},function(){w=!1}),w=!0},C=function(t){n(),g.firstPage||(g.firstPage=t.path||""),g.appShowCount=+g.appShowCount+1,g.appShowTime=Date.now(),g.scene=d[+t.scene]||g.scene,u({event:"WECHAT_WXA__SHOW",attr1:g.appHideCount,attr2:g.appShowCount,attr3:g.firstPage,attr4:g.scene,attr5:t.referrerInfo&&t.referrerInfo.appId||""}),wx.showShareMenu({withShareTicket:!0})},y=function(t,n){g.appHideCount=+g.appHideCount+1;var a=Date.now();g.isFirstOpen&&(g.isFirstOpen=!1),g.stayDuration=a-(g.appShowTime||a),e(),u({event:"WECHAT_WXA__HIDE",attr1:g.appHideCount,attr2:g.appShowCount,attr3:g.totalPageShowCount,attr4:g.stayDuration,attr5:g.firstPage,attr6:g.lastPage,attr7:g.scene})},A=function(t,n){g.totalPageShowCount=+g.totalPageShowCount+1;var e={event:"WECHAT_WXA__PAGE_SHOW",attr1:this.route,attr2:g.lastPage,attr3:this.route===g.firstPage?"YES":"NO",attr4:g.scene};this.options.qrcodeId&&(e.attr8=this.options.qrcodeId,e.qrcodeId=this.options.qrcodeId),u(e)},_=function(t,n){g.lastPage=this.route},P=function(t,n){var e=this;if(void 0!==t)return u({event:"WECHAT_WXA__PAGE_SHARE",attr1:e.route||l.defaultPath}),t[1]},k=App;App=function(t){p(t,"onLaunch",v),p(t,"onShow",C),p(t,"onHide",y),k(t)};var E=Page;Page=function(t){p(t,"onShow",A),p(t,"onHide",_),"function"==typeof t.onShareAppMessage&&h(t,"onShareAppMessage",P),E(t)}}("https://app.linkflowtech.com");